@page "/404"
@implements IDisposable
@inject NavigationManager NavManager
@inject IHttpContextAccessor HttpContextAccessor

<div class="flex flex-col items-center justify-center min-h-[70vh] text-center p-6 bg-gray-50">

    <h1 class="text-9xl font-extrabold text-indigo-700 tracking-widest animate-bounce">
        404
    </h1>

    <div class="bg-red-500 text-white px-4 py-2 text-sm rounded-lg rotate-3 shadow-xl mb-8">
        PAGE NOT FOUND
    </div>

    <p class="text-xl text-gray-700 mb-6">
        Oops! We couldn't find the page. Maybe a quantum fluctuation shifted the bits?
    </p>

    <div class="p-4 rounded-xl bg-gray-100 shadow-inner w-full max-w-sm mb-8">
        <p class="text-md text-gray-600 font-medium">
            Redirecting in <span class="text-indigo-600 text-2xl font-bold">@countdownSeconds</span> seconds...
        </p>
    </div>

    <button @onclick="GoHome"
            class="px-8 py-3 text-lg font-semibold text-white bg-green-500 rounded-full shadow-lg 
                   hover:bg-green-600 transform hover:scale-105 transition duration-300 ease-in-out">
        Go Home
    </button>

</div>

@code {
    private Timer? timer;
    private int countdownSeconds = 10;

    protected override void OnInitialized()
    {
        var context = HttpContextAccessor.HttpContext;
        if (context != null && !context.Response.HasStarted)
        {
            context.Response.StatusCode = 404;
        }
        timer = new Timer(_ =>
        {
            InvokeAsync(() =>
            {
                countdownSeconds--;

                if (countdownSeconds <= 0)
                {
                    timer?.Dispose();
                    NavManager.NavigateTo("/", true);

                }

                StateHasChanged();
            });
        }, null, 1000, 1000);
    }

    private void GoHome()
    {
        timer?.Dispose();
        NavManager.NavigateTo("/", true);

    }

    public void Dispose()
    {
        timer?.Dispose();
    }
}